<!DOCTYPE html>
<html>
<head>
<title>Readable Visual Calculator</title>

<style>
body {
    background-color: #ffeef5;
    font-family: 'OpenDyslexic', Arial;
    text-align: center;
    padding: 20px;
}

h1 {
    color: #ff9ec4;
}

.calculator {
    background: #ffffff;
    padding: 20px;
    border-radius: 20px;
    display: inline-block;
    box-shadow: 0 5px 15px rgba(255,182,193,0.3);
}

#display {
    width: 220px;
    height: 40px;
    font-size: 22px;
    margin-bottom: 10px;
    text-align: right;
    padding: 5px;
    border: 1px solid #ffd6e7;
    border-radius: 8px;
}

.keypad button {
    width: 50px;
    height: 50px;
    margin: 5px;
    font-size: 18px;
    border: none;
    border-radius: 12px;
    background: #ffd6e7;
    cursor: pointer;
    font-family: 'OpenDyslexic', Arial;
    transition: 0.2s;
}

.keypad button:hover {
    background: #ffc2db;
}

.clear-btn {
    background: #ffe0ea !important;
}

#visualArea {
    margin-top: 30px;
    min-height: 120px;
}

.fruit {
    font-size: 55px;
    margin: 10px;
    display: inline-block;
    transition: 0.3s;
}

.bulge {
    transform: scale(1.5);
}

#explanation {
    margin-top: 15px;
    font-size: 20px;
    color: #555;
}

.back-btn {
    margin-top: 20px;
    padding: 10px 25px;
    font-size: 16px;
    border-radius: 20px;
    border: none;
    background: #ffd6e7;
    font-family: 'OpenDyslexic', Arial;
    cursor: pointer;
    transition: 0.2s;
}

.back-btn:hover {
    background: #ffc2db;
}
</style>
</head>

<body>

<h1>üçé Visual Math Calculator üçä</h1>

<div class="calculator">
    <input type="text" id="display" disabled>

    <div class="keypad">
        <br>
        <button onclick="press('7')">7</button>
        <button onclick="press('8')">8</button>
        <button onclick="press('9')">9</button>
        <button onclick="press('/')">√∑</button>
        <br>
        <button onclick="press('4')">4</button>
        <button onclick="press('5')">5</button>
        <button onclick="press('6')">6</button>
        <button onclick="press('*')">√ó</button>
        <br>
        <button onclick="press('1')">1</button>
        <button onclick="press('2')">2</button>
        <button onclick="press('3')">3</button>
        <button onclick="press('-')">-</button>
        <br>
        <button onclick="press('0')">0</button>
        <button onclick="calculate()">=</button>
        <button onclick="clearDisplay()" class="clear-btn">C</button>
        <button onclick="press('+')">+</button>
    </div>
</div>

<div id="visualArea"></div>
<div id="explanation"></div>

<!-- GO BACK BUTTON -->
<button class="back-btn" onclick="goBack()">‚¨Ö Go Back</button>

<script>

let fruits = [];
let currentIndex = 0;
let count = 0;

function press(value) {
    document.getElementById("display").value += value;
}

function clearDisplay() {
    document.getElementById("display").value = "";
    document.getElementById("visualArea").innerHTML = "";
    document.getElementById("explanation").innerHTML = "";
    speechSynthesis.cancel();
    fruits = [];
    currentIndex = 0;
    count = 0;
}

function calculate() {
    const expression = document.getElementById("display").value;

    let result;
    try {
        result = Math.floor(eval(expression));
    } catch {
        alert("Invalid Expression");
        return;
    }

    generateFruits(result);
}

function generateFruits(result) {

    const visual = document.getElementById("visualArea");
    const explanation = document.getElementById("explanation");

    visual.innerHTML = "";
    explanation.innerHTML = "Press ‚û° Arrow key to count!";

    fruits = [];
    currentIndex = 0;
    count = 0;

    if(result < 0) result = 0;

    for(let i = 0; i < result; i++) {
        let span = document.createElement("span");
        span.className = "fruit";
        span.innerHTML = "üçé";
        visual.appendChild(span);
        fruits.push(span);
    }

    if(result === 0) {
        explanation.innerHTML = "Result is 0 üå∏";
    }
}

document.addEventListener("keydown", function(e) {
    if(e.key === "ArrowRight") {
        movePointer();
    }
});

function movePointer() {

    if(currentIndex >= fruits.length) {
        document.getElementById("explanation").innerHTML =
            "üåü Total = " + count + "! Amazing!";
        return;
    }

    const fruit = fruits[currentIndex];

    fruit.classList.add("bulge");

    count++;
    speakNumber(count);

    document.getElementById("explanation").innerHTML =
        "Counting: " + count;

    setTimeout(() => {
        fruit.classList.remove("bulge");
    }, 400);

    currentIndex++;
}

function speakNumber(num) {

    let speech = new SpeechSynthesisUtterance(num.toString());
    speech.rate = 0.9;
    speech.pitch = 1.3;

    const voices = speechSynthesis.getVoices();
    let femaleVoice = voices.find(v =>
        v.name.toLowerCase().includes("zira") ||
        v.name.toLowerCase().includes("female") ||
        v.name.toLowerCase().includes("samantha")
    );

    if(femaleVoice) speech.voice = femaleVoice;

    speechSynthesis.speak(speech);
}

/* GO BACK FUNCTION */
function goBack() {
    clearDisplay();
    window.location.href = "lab.html"; 
    // Change index.html if your main page has a different name
}

</script>

</body>
</html>